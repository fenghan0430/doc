### 翻墙的理由

网络加速。绕过防火长城GFW。

### 翻墙的实现

通用的VPN是一种协议，很容易被GFW识别，所以弃用。现在有很多翻墙协议如SS，V2ray整体思想都是：通过劫持本地的tcp、udp包，通过规则决定是否加密，（假设需要加密）对数据加密后，把数据发到代理服务器，代理服务器走国际出口（专线）到国外，解密数据帮我们访问，得到结果再原路返回。实现翻墙。

### TUN是什么

TUN创建一个虚拟网卡，让整台电脑的数据都通过虚拟网卡访问。和上面原理是相同的。优点是可以代理所有流量tcp/udp。

### DNS泄露

我们想要访问一个网站需要把它的域名解析成ip，DNS又是明文的，容易被其他人获取，导致我们得不到正确的ip，造成网站无法访问。为保护DNS不泄露，需要使用DoH/DoT对DNS加密。

### 最佳实现

> 客户端：V2rayN 6.30

#### 路由设置

- `域名解析策略`使用`IPIfNonMatch` (如果访问的网站在规则内没有匹配任何规则，则发起DNS解析，然后再匹配一遍。可能会导致dns泄露，但是可以访问小众网站。)

#### DNS设置

`V2ray DNS设置`(系统代理)填入这些

```json
{
  "hosts": {
    "proxy.example.com": "127.0.0.1"
  },
  "servers": [
    {
      "address": "223.5.5.5",
      "domains": [
        "geosite:cn"
      ],
      "expectIPs": [
        "geoip:cn"
      ]
    },
    "https://1.1.1.1/dns-query",
    "8.8.8.8"
  ]
}
```

> 解析：如果这个域名是CN的，就向`223.5.5.5`发起解析。如果不是，先向`1.1.1.1`发起DoH解析，如果成功就返回ip，如果不成功就向`8.8.8.8`发起明文解析。

